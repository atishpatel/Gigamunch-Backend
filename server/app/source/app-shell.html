<link rel="import"
      href="../bower_components/polymer/polymer.html">
<link rel="import"
      href="../bower_components/app-route/app-location.html">
<link rel="import"
      href="../bower_components/app-route/app-route.html">
<link rel="import"
      href="../bower_components/app-layout/app-drawer/app-drawer.html">
<link rel="import"
      href="../bower_components/app-layout/app-scroll-effects/app-scroll-effects.html">
<link rel="import"
      href="../bower_components/app-layout/app-header/app-header.html">
<link rel="import"
      href="../bower_components/app-layout/app-header-layout/app-header-layout.html">
<link rel="import"
      href="../bower_components/app-layout/app-toolbar/app-toolbar.html">
<link rel="import"
      href="../bower_components/paper-button/paper-button.html">
<link rel="import"
      href="../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import"
      href="../bower_components/paper-tabs/paper-tabs.html">
<link rel="import"
      href="../bower_components/paper-item/paper-item.html">
<link rel="import"
      href="../bower_components/paper-dialog/paper-dialog.html">
<link rel="import"
      href="../bower_components/iron-pages/iron-pages.html">
<link rel="import"
      href="../bower_components/iron-selector/iron-selector.html">
<link rel="import"
      href="../bower_components/iron-media-query/iron-media-query.html">
<link rel="import"
      href="app-icons.html">
<link rel="import"
      href="app-footer.html">
<link rel="import"
      href="home-page.html">
<link rel="import"
      href="becomechef-page.html">

<dom-module id="app-shell">

  <template>

    <style>
       :host {
        display: block;
        --app-primary-color: #FF7043;
        --accent-color: var(--paper-light-blue-a200);
        --light-accent-color: var(--paper-light-blue-a100);
        --dark-accent-color: var(--paper-light-blue-a400);
        --primary-text-opacity: .87;
        --primary-text-color: var(--paper-grey-900);
        --secondary-text-opacity: .54;
        --secondary-text-color: #727272;
        --gray-line-color: #CFD8DC;
        color: var(--primary-text-color);
        --paper-tabs-selection-bar-color: var(--light-accent-color);
        --paper-tab-ink: var(--light-accent-color);
        /* paper-button */
        --paper-button: {
          background: var(--dark-accent-color);
          color: white;
          min-width: 5em;
          text-transform: none;
        }
      }
      
      app-drawer {
        z-index: 10;
      }
      
      app-toolbar {
        z-index: 9;
      }
      
      app-header,
      app-header-layout {
        z-index: 8;
      }
      
      app-header-layout {
        position: inherit;
      }
      
      app-header {
        background-color: white;
        color: var(--app-primary-color);
      }
      
      app-header paper-icon-button {
        --paper-icon-button-ink-color: black;
      }
      
      .content {
        width: 100%;
        max-width: 1000px;
        margin: auto;
      }
      
      @font-face {
        font-family: 'NexaBold';
        src: url('https://storage.googleapis.com/gigamunch-omninexus-website/fonts/nexa_bold.otf') format('opentype');
      }
      
      @font-face {
        font-family: 'NexaLight';
        src: url('https://storage.googleapis.com/gigamunch-omninexus-website/fonts/nexa_light.otf') format('opentype');
      }
      
      .logo {
        font-family: 'NexaBold', sans-serif;
        letter-spacing: .05em;
        text-decoration: none;
      }
      
      .nav-a {
        text-decoration: none;
        outline: 0;
        color: #546E7A;
      }
      
      .drawer-toolbar {
        height: 64px;
        background-color: var(--app-primary-color);
        font-size: 14px;
      }
      
      .drawer-toolbar .logo {
        font-size: 20px;
        color: white;
        text-decoration: none;
        outline: 0;
      }
      
      .drawer-list {
        padding-top: 8px;
        font-size: 14px;
      }
      
      .drawer-list a {
        display: block;
        color: #546E7A;
      }
      
      .drawer-list a.iron-selected {
        background-color: #ECEFF1;
      }
      
      .drawer-list paper-item {
        font-size: inherit;
        font-weight: 500;
      }
      
      .toolbar {
        display: flex;
        height: 100%;
        justify-content: space-between;
      }
      
      .toolbar-left,
      .toolbar-right {
        display: flex;
        align-items: center;
        flex-direction: row;
      }
      
      .toolbar-title {
        margin-top: 3px;
        color: var(--app-primary-color);
      }
      
      .nav-tabs {
        height: 64px;
        margin-right: 12px
      }
      
      .nav-tabs .fake-paper-tab {
        display: inline-flex;
        opacity: .8;
        -webkit-font-smoothing: antialiased;
      }
      
      .nav-tabs a {
        display: flex;
        align-items: center;
        padding: 0 15px;
      }
      
      .hide {
        display: none;
      }
      
      .login-dialog paper-dialog-scrollable {
        padding: 0;
      }
      
      .login-dialog-close-icon {
        margin: 12px 12px 0 12px;
      }
      
      .login-dialog-content {
        min-width: 320px;
        min-height: 250px;
        padding: 25px;
        text-align: center;
      }
      
      @media (max-width: 767px) {
        .login-dialog {
          position: fixed;
          overflow-x: hidden;
          top: 0;
          left: 0;
          margin: 0;
          width: 100%;
          height: 100%;
        }
      }
      
      #gitkitWidget ::content .gitkit-container,
      #gitkitWidget ::content .gitkit-container-outer {
        background-color: #fff;
        box-sizing: content-box;
        -moz-box-sizing: content-box;
        -webkit-box-sizing: content-box;
        box-sizing: content-box;
        -moz-box-sizing: content-box;
        -webkit-box-sizing: content-box;
        color: #111;
        font: 14px "Helvetica Neue", helvetica, arial, sans-serif;
        overflow: hidden;
        position: relative
      }
      
      #gitkitWidget ::content .gitkit-container {
        direction: ltr;
        margin: 0 auto;
        padding: 10px;
        width: 300px
      }
      
      #gitkitWidget ::content .gitkit-container-outer {
        box-shadow: 0 0 0.6em #ccc;
        -webkit-box-shadow: 0 0 0.6em #ccc;
        -moz-box-shadow: 0 0 0.6em #ccc;
        padding: 35px 50px
      }
      
      #gitkitWidget ::content .gitkit-container-outer #gitkitWidget ::content .gitkit-container {
        min-width: 300px;
        width: inherit
      }
      
      #gitkitWidget ::content .gitkit-title {
        direction: ltr;
        font-size: 20px;
        font-weight: normal;
        line-height: 1.2;
        margin-bottom: 18px;
        margin-top: 12px;
        padding-bottom: 7px;
        text-align: left
      }
      
      #gitkitWidget ::content .gitkit-text {
        direction: ltr;
        margin: 14px 0;
        text-align: left
      }
      
      #gitkitWidget ::content .gitkit-error {
        color: #e54b31;
        direction: ltr;
        line-height: 18px;
        margin: -16px 0 16px;
        text-align: left
      }
      
      #gitkitWidget ::content .gitkit-list-item {
        direction: ltr;
        margin: 0;
        padding: 0;
        text-align: left
      }
      
      #gitkitWidget ::content .gitkit-hidden {
        display: none
      }
      
      #gitkitWidget ::content .gitkit-relative-wrapper {
        position: relative
      }
      
      #gitkitWidget ::content .gitkit-label {
        direction: ltr;
        display: block;
        font-weight: bold;
        line-height: 1.2;
        margin-bottom: 7px;
        text-align: left
      }
      
      #gitkitWidget ::content .gitkit-checkbox-label {
        direction: ltr;
        display: inline-block;
        font-weight: normal;
        text-align: left
      }
      
      #gitkitWidget ::content .gitkit-input,
      #gitkitWidget ::content .gitkit-input-invalid {
        border: 1px solid #ddd;
        border-top: 1px solid #ccc;
        box-sizing: border-box;
        -moz-box-sizing: border-box;
        -webkit-box-sizing: border-box;
        direction: ltr;
        display: inline-block;
        font-size: 15px;
        height: 32px;
        margin: 0 0 24px;
        max-width: 300px;
        padding-left: 8px;
        width: 100%
      }
      
      #gitkitWidget ::content .gitkit-input-invalid {
        border: 1px solid #e54b31
      }
      
      #gitkitWidget ::content .gitkit-recaptcha {
        margin-bottom: 24px;
        text-align: center
      }
      
      #gitkitWidget ::content .gitkit-button {
        background-color: #f5f5f5;
        background-image: linear-gradient(top, #f5f5f5, #f1f1f1);
        background-image: -moz-linear-gradient(top, #f5f5f5, #f1f1f1);
        background-image: -ms-linear-gradient(top, #f5f5f5, #f1f1f1);
        background-image: -o-linear-gradient(top, #f5f5f5, #f1f1f1);
        background-image: -webkit-linear-gradient(top, #f5f5f5, #f1f1f1);
        border: 1px solid #dcdcdc;
        border-radius: 3px;
        -moz-border-radius: 3px;
        -webkit-border-radius: 3px;
        color: #444;
        cursor: default;
        display: inline-block;
        font: 13px "Helvetica Neue", helvetica, arial, sans-serif;
        font-weight: bold;
        height: 32px;
        line-height: 32px;
        margin: 0;
        min-width: 54px;
        padding: 0 12px;
        text-align: center;
        text-decoration: none;
        user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        -webkit-user-select: none
      }
      
      #gitkitWidget ::content .gitkit-button:hover {
        background-color: #eeeeee;
        background-image: linear-gradient(top, #ededed, #e0e0e0);
        background-image: -moz-linear-gradient(top, #ededed, #e0e0e0);
        background-image: -ms-linear-gradient(top, #ededed, #e0e0e0);
        background-image: -o-linear-gradient(top, #ededed, #e0e0e0);
        background-image: -webkit-linear-gradient(top, #ededed, #e0e0e0);
        border: 1px solid #c6c6c6;
        box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
        -webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
        -moz-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
        color: #111;
        transition: all 0.0s;
        -moz-transition: all 0.0s;
        -ms-transition: all 0.0s;
        -o-transition: all 0.0s;
        -webkit-transition: all 0.0s
      }
      
      #gitkitWidget ::content .gitkit-button:active {
        background-color: #f6f6f6;
        background-image: linear-gradient(top, #ededed, #e0e0e0);
        background-image: -moz-linear-gradient(top, #ededed, #e0e0e0);
        background-image: -ms-linear-gradient(top, #ededed, #e0e0e0);
        background-image: -o-linear-gradient(top, #ededed, #e0e0e0);
        background-image: -webkit-linear-gradient(top, #ededed, #e0e0e0);
        box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.1);
        -moz-box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.1);
        -webkit-box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.1)
      }
      
      #gitkitWidget ::content .gitkit-link {
        color: #018ed7;
        font-variant: normal;
        font-weight: normal;
        text-decoration: none
      }
      
      #gitkitWidget ::content .gitkit-link:hover {
        text-decoration: underline
      }
      
      #gitkitWidget ::content .gitkit-form-actions {
        direction: ltr;
        margin-bottom: 14px;
        text-align: left
      }
      
      #gitkitWidget ::content .gitkit-edit-action {
        background: url(https://www.gstatic.com/authtoolkit/image/edit.png) top left no-repeat;
        display: inline-block;
        line-height: 25px;
        padding-left: 30px
      }
      
      #gitkitWidget ::content .gitkit-remove-action {
        background: url(https://www.gstatic.com/authtoolkit/image/trash.png) top left no-repeat;
        display: inline-block;
        height: 24px;
        margin-left: 22px;
        width: 24px
      }
      
      #gitkitWidget ::content .gitkit-indent {
        margin-left: 1em
      }
      
      #gitkitWidget ::content .gitkit-sign-in-options {
        direction: ltr;
        margin: -16px 0 24px;
        position: relative;
        text-align: left
      }
      
      #gitkitWidget ::content .gitkit-tos {
        direction: ltr;
        margin-bottom: 24px;
        text-align: left
      }
      
      #gitkitWidget ::content .gitkit-arrow-indicator,
      #gitkitWidget ::content .gitkit-arrow-indicator-active {
        border: none;
        bottom: 24px;
        height: 32px;
        padding: 0;
        position: absolute;
        right: 0px;
        width: 32px
      }
      
      #gitkitWidget ::content .gitkit-arrow-indicator {
        background: url(https://www.gstatic.com/authtoolkit/image/indicator-left.png) no-repeat center
      }
      
      #gitkitWidget ::content .gitkit-arrow-indicator-active {
        background: url(https://www.gstatic.com/authtoolkit/image/indicator-active-left.png) no-repeat center
      }
      
      #gitkitWidget ::content .gitkit-recommend-option {
        margin-bottom: 24px;
        margin-top: -24px
      }
      
      #gitkitWidget ::content .gitkit-idp-list {
        list-style: none;
        margin: 1em 0;
        padding: 0
      }
      
      #gitkitWidget ::content .gitkit-idp-button {
        direction: ltr;
        display: inline-block;
        height: 48px;
        text-align: left;
        vertical-align: middle;
        width: 100%
      }
      
      #gitkitWidget ::content .gitkit-idp-list>.gitkit-list-item {
        margin-bottom: 15px
      }
      
      #gitkitWidget ::content .gitkit-idp-icon {
        border: none;
        display: inline-block;
        height: 48px;
        vertical-align: middle;
        width: 48px
      }
      
      #gitkitWidget ::content .gitkit-idp-favicon {
        border: none;
        display: inline-block;
        height: 14px;
        margin-right: 5px;
        vertical-align: middle;
        width: 14px
      }
      
      #gitkitWidget ::content .gitkit-idp-text {
        color: #fff;
        display: inline-block;
        font-size: 18px;
        font-weight: bold;
        text-align: center;
        vertical-align: middle;
        width: 252px
      }
      
      #gitkitWidget ::content .gitkit-idp-password {
        background-color: #7f7f7f
      }
      
      #gitkitWidget ::content .gitkit-idp-google {
        background-color: #4285f4
      }
      
      #gitkitWidget ::content .gitkit-idp-googleplus {
        background-color: #db4437
      }
      
      #gitkitWidget ::content .gitkit-idp-microsoft {
        background-color: #004185
      }
      
      #gitkitWidget ::content .gitkit-idp-yahoo {
        background-color: #4002af
      }
      
      #gitkitWidget ::content .gitkit-idp-aol {
        background-color: #2ea0df
      }
      
      #gitkitWidget ::content .gitkit-idp-facebook {
        background-color: #3b5998
      }
      
      #gitkitWidget ::content .gitkit-idp-paypal {
        background-color: #008de0
      }
      
      #gitkitWidget ::content .gitkit-idp-twitter {
        background-color: #55acee
      }
      
      #gitkitWidget ::content .gitkit-account-photo {
        display: inline-block;
        height: 48px;
        margin-left: 15px;
        vertical-align: middle;
        width: 48px
      }
      
      #gitkitWidget ::content .gitkit-avatar-with-idp {
        direction: ltr;
        margin: 10px 16px;
        text-align: left
      }
      
      #gitkitWidget ::content .gitkit-info-bar {
        background-color: #f9edbe;
        border: 1px solid #f0c36d;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        -webkit-box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        -moz-box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        left: 10%;
        padding: 8px 16px;
        position: absolute;
        right: 10%;
        text-align: center;
        top: 0
      }
      
      #gitkitWidget ::content .gitkit-info-bar-message {
        font-size: 12px;
        margin: 0
      }
      
      #gitkitWidget ::content .gitkit-busy-indicator {
        background: url(https://www.gstatic.com/authtoolkit/image/loading.gif) no-repeat center center;
        height: 100%;
        left: 0;
        position: absolute;
        top: 0;
        width: 100%
      }
      
      #gitkitWidget ::content .gitkit-callback-indicator-container {
        height: 120px
      }
      
      #gitkitWidget ::content .gitkit-account-chip {
        background: #fff;
        border: 1px solid #dcdcdc;
        box-sizing: border-box;
        -moz-box-sizing: border-box;
        -webkit-box-sizing: border-box;
        display: inline-block;
        height: 62px;
        padding: 8px;
        position: relative;
        user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        -webkit-user-select: none;
        width: 254px
      }
      
      #gitkitWidget ::content .gitkit-account-chip-photo {
        border: 1px solid rgba(0, 0, 0, 0.1);
        height: 42px;
        left: 8px;
        position: absolute;
        top: 8px;
        width: 42px
      }
      
      #gitkitWidget ::content .gitkit-account-chip-name,
      #gitkitWidget ::content .gitkit-account-chip-email,
      #gitkitWidget ::content .gitkit-account-chip-email-only {
        direction: ltr;
        display: block;
        line-height: 18px;
        margin-left: 52px;
        overflow: hidden;
        text-align: left;
        text-overflow: ellipsis
      }
      
      #gitkitWidget ::content .gitkit-account-chip-name {
        font-weight: bold;
        margin-top: 2px;
        white-space: nowrap
      }
      
      #gitkitWidget ::content .gitkit-account-chip-email {
        color: #666
      }
      
      #gitkitWidget ::content .gitkit-account-chip-email-only {
        color: #111;
        font-weight: bold;
        margin-top: 12px
      }
      
      #gitkitWidget ::content .gitkit-account-chip-email-label {
        display: inline-block;
        overflow: hidden;
        text-overflow: ellipsis;
        vertical-align: text-bottom;
        width: 165px
      }
      
      #gitkitWidget ::content .gitkit-sign-in-button {
        display: inline-block
      }
      
      #gitkitWidget ::content .gitkit-user-card {
        color: #111;
        font: 14px "Helvetica Neue", helvetica, arial, sans-serif;
        position: relative;
        width: 254px
      }
      
      #gitkitWidget ::content .gitkit-user-card-chip {
        cursor: pointer;
        outline: none
      }
      
      #gitkitWidget ::content .gitkit-user-card-arrow {
        background: url("https://www.gstatic.com/authtoolkit/image/down-arrow.png") no-repeat right center;
        height: 4px;
        position: absolute;
        top: 31px;
        width: 97%
      }
      
      #gitkitWidget ::content .gitkit-user-card-menu {
        border: 1px solid #dcdcdc;
        border-width: 0 1px 1px 1px;
        box-sizing: border-box;
        -moz-box-sizing: border-box;
        -webkit-box-sizing: border-box;
        direction: ltr;
        list-style: none;
        margin: 0;
        padding: 0;
        position: absolute;
        width: inherit
      }
      
      #gitkitWidget ::content .gitkit-user-card-menuitem {
        background: #fff;
        color: #018ed7;
        display: block;
        margin: 0;
        outline: none;
        overflow: hidden;
        padding: 15px 8px;
        text-overflow: ellipsis;
        white-space: nowrap
      }
      
      #gitkitWidget ::content .gitkit-user-card-menuitem:hover,
      #gitkitWidget ::content .gitkit-user-card-menuitem:focus {
        background: #f4f4f4;
        cursor: pointer
      }
      
      #gitkitWidget ::content .gitkit-manage-account-list {
        border: 1px solid #e4e0e0;
        list-style: none;
        padding: 0
      }
      
      #gitkitWidget ::content .gitkit-manage-account-list>.gitkit-list-item {
        border-bottom: 1px solid #e4e0e0;
        padding: 10px
      }
      
      #gitkitWidget ::content .gitkit-manage-account-list>.gitkit-list-item:last-of-type {
        border-bottom: none
      }
      
      #gitkitWidget ::content .gitkit-account-chip-list {
        list-style: none;
        margin: 1em 0;
        padding: 0
      }
      
      #gitkitWidget ::content .gitkit-account-chip-list>.gitkit-list-item {
        margin-bottom: 24px
      }
      
      @media (max-width:500px) {
        #gitkitWidget ::content .gitkit-container-outer {
          box-shadow: none;
          -webkit-box-shadow: none;
          -moz-box-shadow: none;
          padding: 10px 0
        }
        #gitkitWidget ::content .gitkit-container-outer #gitkitWidget ::content .gitkit-container {
          padding: 0px
        }
        #gitkitWidget ::content .gitkit-manage-account-list {
          border-left: none;
          border-right: none
        }
      }
      /* Custom gitkit widget */
      
      #gitkitWidget ::content .gitkit-title,
      #gitkitWidget ::content .gitkit-info-bar {
        display: none;
      }
      
      #gitkitWidget ::content .gitkit-list-item {
        box-shadow: 0 2px 2px 0 rgba(0, 0, 0, 0.14), 0 1px 5px 0 rgba(0, 0, 0, 0.12), 0 3px 1px -2px rgba(0, 0, 0, 0.2);
      }

    </style>

    <app-location route="{{route}}">
    </app-location>
    <app-route route="{{route}}"
               pattern="/:page"
               data="{{routeData}}"
               tail="{{subroute}}">
    </app-route>
    </app-route>
    <iron-media-query query="max-width: 767px"
                      query-matches="{{smallScreen}}">
    </iron-media-query>

    <!-- Login dialog -->
    <paper-dialog id="signUp"
                  class="login-dialog"
                  modal>
      <paper-dialog-scrollable>
        <div>
          <paper-icon-button class="login-dialog-close"
                             icon="app:close"
                             dialog-dismiss></paper-icon-button>
        </div>
        <div class="login-dialog-content">
          <h2>Sign up/Log in</h2>
          <div id="gitkitWidget"></div>
        </div>
      </paper-dialog-scrollable>
    </paper-dialog>
    <!-- Drawer content -->
    <app-drawer id="drawer"
                opened="{{drawerOpened}}"
                swipe-open="[[smallScreen]]"
                hidden="[[hideNav]]">
      <app-toolbar class="drawer-toolbar">
        <a class="nav-a"
           href="/">
          <div class="logo">Gigamunch</div>
        </a>
      </app-toolbar>
      <iron-selector selected="[[page]]"
                     attr-for-selected="name"
                     class="drawer-list"
                     role="navigation">
        <a class="nav-a"
           href="[[loginBtnUrl]]">
          <paper-item>[[loginBtnText]]</paper-item>
        </a>
        <a class="nav-a"
           name="home"
           href="/">
          <paper-item>Home</paper-item>
        </a>
        <a class="nav-a"
           name="becomechef"
           href="/becomechef">
          <paper-item>Become a Cook</paper-item>
        </a>
        <a class="nav-a"
           name="faq"
           href="/faq">
          <paper-item>FAQ</paper-item>
        </a>
        <a class="nav-a"
           name="about"
           href="/about">
          <paper-item>About</paper-item>
        </a>
      </iron-selector>
    </app-drawer>

    <!-- Main content -->
    <app-header-layout id="headerLayout"
                       has-scrolling-region>
      <app-header condenses
                  reveals
                  effects="waterfall"
                  hidden="[[hideNav]]">
        <app-toolbar>
          <div class="toolbar content">
            <div class="toolbar-left">
              <paper-icon-button id="menuIcon"
                                 class="hide"
                                 icon="app:menu"
                                 on-tap="toggleDrawer">
              </paper-icon-button>
              <a class="nav-a"
                 href="/">
                <div class="toolbar-title logo"
                     main-title
                     title>Gigamunch</div>
              </a>
            </div>
            <div id="toolbarRight"
                 class="toolbar-right hide">
              <paper-tabs class="nav-tabs"
                          attr-for-selected="name"
                          selected="{{page}}"
                          tabindex="-1">
                <paper-tab name="home"
                           tabindex="-1">
                  <a class="nav-a"
                     href="/"><span>Home</span></a>
                </paper-tab>
                <paper-tab name="becomechef"
                           tabindex="-1">
                  <a class="nav-a"
                     href="/becomechef"><span>Become a chef</span></a>
                </paper-tab>
                <paper-tab name="faq"
                           tabindex="-1">
                  <a class="nav-a"
                     href="/faq"><span>FAQ</span></a>
                </paper-tab>
                <paper-tab name="about"
                           tabindex="-1">
                  <a class="nav-a"
                     href="/about"><span>About</span></a>
                </paper-tab>
                <div class="fake-paper-tab">
                  <a class="nav-a"
                     href="[[loginBtnUrl]]"
                     on-tap="login">
                    <span>[[loginBtnText]]</span>
                  </a>
                </div>
                </a>
              </paper-tabs>
            </div>
          </div>
        </app-toolbar>
      </app-header>

      <iron-pages role="main"
                  selected="[[page]]"
                  attr-for-selected="name">
        <home-page id="home"
                   user="[[user]]"
                   name="home"></home-page>
        <becomechef-page id="becomechef"
                         name="becomechef"
                         user="[[user]]"></becomechef-page>
        <faq-page id="faq"
                  name="faq"></faq-page>
        <terms-page id="terms"
                    name="terms"></terms-page>
        <privacy-page id="privacy"
                      name="privacy"></privacy-page>
        <upgrade-page name="upgrade"></upgrade-page>
        <about-page id="about"
                    name="about"></about-page>
      </iron-pages>

      <!-- Footer -->
      <app-footer hidden="[[hideNav]]"></app-footer>
    </app-header-layout>

  </template>

  <script>
    Polymer({
      is: 'app-shell',
      properties: {
        page: {
          type: String,
          reflectToAttribute: true,
          observer: 'pageChanged',
        },
        drawerOpened: {
          type: Boolean,
        },
        loginBtnUrl: {
          type: String,
        },
        loginBtnText: {
          type: String,
        },
        user: {
          type: Object,
          notify: true,
        },
        hideNav: {
          type: Boolean,
          value: false,
        },
      },
      observers: [
        'routePageChanged(routeData.page)',
        'routePathChanged(route.path)',
        'screenChanged(smallScreen)',
      ],
      listeners: {
        'signup': 'signUp',
        'login': 'login',
      },
      signUp: function() {
        if (this.user && this.user.id) {
          return;
        }
        // set text to register
        this.$.signUp.open();
        return;
      },
      login: function() {
        if (this.user && this.user.id) {
          return;
        }
        // set text to login
        this.$.signUp.open();
        return;
      },
      ready: function() {
        this.updateIsUserLoggedIn();
        // setup gitkit stuff 
        if (this.user === undefined || this.user === null || this.user.id === undefined) {
          var apiKey;
          if (location.hostname.includes('gigamunch-omninexus-dev.appspot.com') || location.hostname === 'localhost') {
            apiKey = 'AIzaSyBHPe4B4k72ljnBXszda6AJGGg21YqEJ4g';
          } else {
            apiKey = 'AIzaSyCB8i30D0GkFPW6_mKf9ph8voFFMQoarO0';
          }
          google.identitytoolkit.start(
            '#gitkitWidget', {
              apiKey: apiKey,
              signInSuccessUrl: '/login',
              popupMode: true,
              oobActionUrl: '/sendemail',
              displayMode: 'providerFirst',
              signInOptions: ["google", "facebook", "password"],
              siteName: 'Gigamunch',
              accountChooserEnabled: false,
            },
            '');
        }
      },
      updateIsUserLoggedIn: function() {
        var token = this.getTokenCookie();
        if (token !== undefined && token !== '') {
          this.loginBtnUrl = '/cook/';
          this.loginBtnText = 'My Dashboard';
          this.user = {};
          var userString = token.split('.')[1];
          var jwt = JSON.parse(window.atob(userString));
          for (var k in jwt) {
            if (k !== '__proto__') {
              this.user[k] = jwt[k];
            }
          }
          return;
        }
        this.loginBtnUrl = '/becomechef?gstate=login';
        this.loginBtnText = 'Sign up/Log in';
        this.user = null;
        return;
      },
      routePageChanged: function(page) {
        this.page = page || 'home';
      },
      // routePathChanged determines if the page is part of this app or a URL outside this app. 
      // If the URL is outside this app, it causes the browser to go to that app.
      routePathChanged: function(path) {
        // ** all pages must be in this list
        var pages = ['/', '/home', '/becomechef', '/faq', '/terms', '/privacy', '/upgrade', '/about', '/sell'];
        var found = false;
        for (var i = 0; i < pages.length; i++) {
          if (path === pages[i]) {
            found = true;
          }
        }
        if (!found) {
          // force page reload
          window.location = path;
        }
        if (location.search.includes('nav=f')) {
          this.hideNav = true;
        }
        if (path === '/becomechef' || path === '/sell' && this.user !== null) {
          if (location.search.includes('gstate=login')) {
            this.login();
          } else if (location.search.includes('gstate=signup')) {
            this.signup();
          }
        }
      },
      pageChanged: function(page) {
        if (page !== 'home' && page !== 'cook') { // since home is included in this page
          // load page import on demand.
          this.importHref(
            this.resolveUrl(page + '-page' + '.html'), null, null, true);
        }
        this.drawerOpened = false;
        var title;
        if (page === 'home') {
          title = 'Gigamunch | Buy homemade food from local cooks';
        } else {
          title = page.charAt(0).toUpperCase() + page.slice(1);
        }
        document.title = title + ' | Gigamunch';
        app.$.headerLayout.$.contentContainer.scrollTop = 0;

      },
      screenChanged: function(smallScreen) {
        this.$.menuIcon.toggleClass('hide', !smallScreen);
        if (smallScreen) {
          this.$.toolbarRight.className += ' hide';
        } else {
          this.$.toolbarRight.className = this.$.toolbarRight.className.replace(/hide/g, '');
        }
      },
      toggleDrawer: function() {
        this.drawerOpened = !this.drawerOpened;
      },
      getTokenCookie: function() {
        var name = 'GIGATKN=';
        var ca = document.cookie.split(';');
        for (var i = 0; i < ca.length; i++) {
          var c = ca[i];
          while (c.charAt(0) === ' ') c = c.substring(1);
          if (c.indexOf(name) === 0) return c.substring(name.length, c.length);
        }
        return '';
      },
    });

  </script>

</dom-module>
